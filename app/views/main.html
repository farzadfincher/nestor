<div ui-layout class="layout-mock" ng-init="init()">
  <ui-layout options="{ flow : 'column' }">

    <!----------------------------------------------------------->
    <!--                     Code Editor                       -->
    <!----------------------------------------------------------->
    <div class="left-column" id="left-column" size="300px">
      <div ui-ace="{theme:'ambiance', mode: 'json', onChange: templateStringChanged}"
           ng-model="templateString">
      </div>
    </div>

    <!----------------------------------------------------------->
    <!--                     Canvas                            -->
    <!----------------------------------------------------------->
    <div ng-drop="true"
         ng-drop-success="onDropComplete($data,$event)"
         id="container"
         plumb-listeners
         on-connection-established="connectionEstablished(sourceName, targetName)"
         on-connection-detached="connectionDetached(sourceName, targetName)"
         on-connection-moved-from-source="connectionMovedFromSource(originalSourceName, newSourceName, targetName)"
         on-connection-moved-from-target="connectionMovedFromTarget(sourceName, originalTargetName, newTargetName)"
         class="center-column">
      <div class="canvasbtns">
        <button class="btn btn-warning" ng-click="cancel()"><span class="glyphicon glyphicon-floppy-save"></span>
        </button>
        <button class="btn btn-primary" ng-click="download()"><span class="glyphicon glyphicon-cloud-download"></span>
        </button>
      </div>
      <!-- The actual components on the canvas -->
      <div plumb-item
           ng-click="clickCallback(component)"
           class="item"
           ng-class="{selectedComponent : component.id === selectedComponent.id}"
           ng-repeat="component in addedComponents"
           ng-style="{ 'left':component.x, 'top':component.y }"
           data-identifier="{{component.id}}"
           data-component-name={{component.name}}
        >
        <img width="100" ng-src="{{component.image}}"/>

        <p class="title">{{component.name}}</p>

        <div plumb-connect
             data-parent-name="{{component.parent}}"
             class="ep"
          ></div>
      </div>
    </div>

    <div
      ui-layout="{flow: 'row'}"
      size="300px"
      class="right-column">
      
      <!----------------------------------------------------------->
      <!--                  Resource Properties                  -->
      <!----------------------------------------------------------->

      <div class="right-column-top" size="410px">
        <form id="searchbox">
          <p class="fieldset">
            <label class="glyphicon glyphicon-search"></label>
          </p>
          <input ng-model="searchText" type="text" placeholder="Search..." required class="search">
        </form>
        <tabset justified="true">

          <tab heading="Components" class="components-tab">
            <div ng-repeat="comp in components | filter:searchText">
              <div
                class="empty-container"
                ng-drag="true"
                ng-drag-success="onDragComplete($data,$event)"
                ng-drag-data="comp"
                ng-center-anchor="false">
              </div>
              <div class="component-item">
                <div class="imgdiv">
                  <img class="component-image" ng-src="{{comp.image}}"/>
                </div>
                <div class="pdiv">
                  <p>
                    {{comp.name}} : {{comp.description}}</p>
                </div>
              </div>
            </div>
          </tab>

          <tab heading="Solutions" class="tasks-tab">
            <div ng-click="taskSelected(task)" ng-repeat="task in tasks | filter:searchText">
              <div class="task-item">

                <a href="">
                     {{task.name}}
                  </a>

              </div>
            </div>
          </tab>
        </tabset>
      </div>

      <!----------------------------------------------------------->
      <!--                  Component Library                    -->
      <!----------------------------------------------------------->
      <div class="right-column-bottom">
        <div ng-show="selectedComponent">
          <div class="cd-fixed-bg">
            <h4 id="titleh4">{{selectedComponent.name}} </h4>
            <h5 id="titleh5">Type: {{selectedComponent.type}}</h5>

            <div class="row generate">
              <div class="action col-sm-7" ng-show="selectedComponent.type === 'EC2'">
                <button ng-click="showModal()" class="label">Generate Scaffolding Code</button>
              </div>
              <div class="action col-sm-5" ng-show="selectedComponent.type === 'EC2'">
                <button ng-click="showModal()" class="label">Deploy Code</button>
              </div>
            </div>
          </div>
          <h5 class="contenth5" ng-show="selectedComponent.required">Required Parameters</h5>

          <component-properties ng-if="!selectedComponent.isDerived"
                                component-properties="selectedComponent.required"
                                resource-properties="template.Resources[selectedComponent.name].Properties"
                                on-property-drag="propertyDidDrag(data, event)"
                                property-name="selectedComponent.name"
                                types="types"></component-properties>

          <!--<pre>{{template.Resources[selectedComponent.parent].Properties[selectedComponent.type] | json}}</pre>-->
          <derived-properties
            ng-if="selectedComponent.isDerived"
            component-properties="selectedComponent.required"
            resource-properties="template.Resources[selectedComponent.parent].Properties[selectedComponent.type]"
            property-name="selectedComponent.name"
            types="types"></derived-properties>

          <h5 class="contenth5" ng-show="selectedComponent.optional">Optional Parameters</h5>

          <component-properties ng-if="!selectedComponent.isDerived"
                                component-properties="selectedComponent.optional"
                                resource-properties="template.Resources[selectedComponent.name].Properties"
                                on-property-drag="propertyDidDrag(data, event)"
                                property-name="selectedComponent.name"
                                types="types"></component-properties>

          <derived-properties
            ng-if="selectedComponent.isDerived"
            component-properties="selectedComponent.optional"
            resource-properties="template.Resources[selectedComponent.parent].Properties[selectedComponent.type]"
            property-name="selectedComponent.name"
            types="types"></derived-properties>
        </div>
      </div>
    </div>
  </ui-layout>
</div>


<!--This is the visual of the component card while its being dragged-->
<div
  ng-drag-clone="" class="dragging">
  <div class="component-item">
    <div class="imgdiv">
      <img class="component-image" ng-src="{{clonedData.image}}"/>
    </div>
    <div class="pdiv">
      <p>
        {{clonedData.name}} : {{clonedData.description}}</p>
    </div>
  </div>
</div>
